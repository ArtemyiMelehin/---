# <center> Сегментация клиентов онлайн магазина.
---
## <center> Признаки данных.

* InvoiceNo — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "C" в начале кода указывает на отмену транзакции);
* Stock Code — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* Description — название товара;
* Quantity — количество каждого товара за транзакцию; 
* InvoiceDate — дата и время выставления счёта/проведения транзакции;
* UnitPrice — цена за единицу товара в фунтах стерлингов;
* CustomerID — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* Country — название страны, в которой проживает клиент.

#### <center> Проект включает в себя 5 разделов:

**Основные цели проекта:**
1. [Произвести предобработку набора данных.](#Предобработка-набора-данных.)
2. [Провести разведывательный анализ данных и выявить основные закономерности.](#Разведывательный-анализ)
3. [Сформировать категории товаров и клиентов.](#Формирование-категории-товаров-и-клиентов.) 
4. [Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.](#Построение-моделей-машинного-обучения)
5. [Спроектировать процесс предсказания категории интересов клиента и протестировать модель на новых клиентах.](#Предсказание-категории-интересов-клиента)


## Предобработка набора данных.
Здесь мы смотрим: 
- правильно ли загрузились наши данные
- из каких столбцов состоят данные, какого типа столбцы
- Посмотрим данные на наличие выбросов и дубликатов.

Во время предобработки мы нашли много интересных примеров, которые без тщательного анализа будут очень мешать моделям машинного обучения.

Н.р: отрицательные значения купленных товаров, стоимость меньше 0 фунтов, особые категории скидок в 1% данных.

## Разведывательный анализ
Этот этап самый интересный, в нём мы изучаем данные на распределение, частоту появления и др.

Также мы визуализировали долю всех клиентов для каждой страны, а также общую прибыль магазина с каждой покупателя отдельной страны.

Ещё мы выяснили, что высший спрос на товары магазина достигаются в преддверии Рождества.

В итоге EDA, мы поняли большинство особенностей наших данных, но они все ещё не готовы для ML-алгоритмов, тогда давайте это исправим!

## Формирование категории товаров и клиентов.
Здесь мы занимаемся RFM-сегментацией клиентов.

Метод заключается в группировке клиентов на основе следующих параметров:
* Recency (Давность) — давность последней покупки клиента;
* Frequency (Частота) — общее количество покупок клиента;
* Monetary Value (Денежная ценность) — сколько денег потратил клиент.

Суть RFM-анализа состоит в том, что мы разделяем всех клиентов на группы в зависимости от того, как давно они сделали последнюю покупку, как часто покупали и насколько большой была сумма их заказов.

Также мы строим [Полярные диаграммы](https://learn.microsoft.com/ru-ru/sql/reporting-services/report-design/polar-charts-report-builder-and-ssrs?view=sql-server-ver16). Это один из способов визуализации профиля кластеров — Radar Chart (полярная, или лепестковая, диаграмма). Это графическое представление значений нескольких эквивалентных категорий в форме «паутины».

Пример полярной диаграммы для задачи кластеризации учеников по интересам:

<img src=https://www.datanovia.com/en/wp-content/uploads/2020/12/radar-chart-in-r-customized-fmstb-radar-chart-1.png width=500>

## Построение моделей машинного обучения
Тут мы строим простые модели машинного обучения: KMeans(), EM-алгоритм, Агломеративная кластеризация, GradientBoostingClassifier()

Кластеры подбираем по методу силуэта.

## Предсказание категории интересов клиента

В дополнение к данным моделям мы оптимизируем подбор гиперпараметров с помощью GridSearch.

## Данные

* Во вложение к проекту есть файл: customer_segmentation_project.csv, который и является исходными данными.

## Используемые зависимости
* Python (3.9):
    * [numpy (1.20.3)](https://numpy.org)
    * [pandas (1.3.4)](https://pandas.pydata.org)
    * [matplotlib (3.4.3)](https://matplotlib.org)
    * [seaborn (0.11.2)](https://seaborn.pydata.org)
    
## Установка проекта
```
    git clone https://github.com/ArtemyiMelehin/Customer_segmentation
```

## Использование
Вся информация о работе представлена в jupyter-ноутбуке Project-6.Сегментация клиентов.ipynb.

## Авторы

Мелехин Артемий
